# 🚀 AI数据探索器使用指南

## 快速开始

### 1. 启动应用
```bash
python start_gradio.py
```
应用将在 http://127.0.0.1:7860 启动

### 2. 上传数据
- 点击"📁 上传Excel文件"
- 选择你的Excel文件（支持.xlsx和.xls格式）
- 我们提供了测试文件 `test_sales_data.xlsx` 供你体验

### 3. 开始探索
在对话框中输入你的分析需求，例如：

## 📊 示例查询

### 基础数据分析
- "显示数据的基本统计信息"
- "数据质量如何？有多少缺失值？"
- "告诉我数据的基本概况"

### 销售分析（使用测试数据）
- "分析2023年的销售趋势，生成趋势图"
- "哪个产品类别销售额最高？"
- "生成各地区销售对比图"
- "分析月度销售变化趋势"
- "客户年龄分布情况如何？"

### 深度分析
- "找出销售额最高的前10天"
- "不同地区的产品偏好有什么差异？"
- "生成产品类别与地区的交叉分析"
- "分析季节性销售模式"

### 可视化要求
- "生成销售额的时间序列图"
- "创建产品类别的饼图"
- "绘制各地区销售额的柱状图"
- "生成价格分布的直方图"
- "创建相关性分析热力图"

## 🎯 最佳实践

### 1. 描述清晰的需求
❌ "分析数据"
✅ "分析月度销售趋势并生成折线图"

### 2. 指定图表类型
- "生成柱状图显示各类别销售额"
- "创建散点图分析价格与数量关系"
- "绘制饼图展示地区分布"

### 3. 多轮对话
- 先问基础信息："数据有哪些列？"
- 再深入分析："基于刚才的信息，分析销售趋势"
- 细化需求："把刚才的图表改为按月聚合"

## 💡 功能特点

### ✅ 支持的功能
- 📊 Excel文件上传和解析
- 🤖 自然语言数据分析
- 📈 自动生成各种图表
- 💬 多轮对话记忆
- 🔍 代码生成和执行
- 🎨 美观的Web界面

### 📋 支持的图表类型
- 折线图 (时间序列、趋势分析)
- 柱状图 (分类对比)
- 饼图 (比例分析)
- 散点图 (相关性分析)
- 直方图 (分布分析)
- 热力图 (相关性矩阵)
- 箱线图 (数据分布)

### 📈 支持的分析类型
- 描述性统计
- 趋势分析
- 分组对比
- 相关性分析
- 异常值检测
- 时间序列分析

## 🔧 技术架构

- **前端**: Gradio (现代化Web界面)
- **AI引擎**: Deepseek API (自然语言理解和代码生成)
- **数据处理**: Pandas (数据分析)
- **可视化**: Matplotlib + Seaborn (图表生成)
- **代码执行**: 本地安全执行 (支持E2B沙箱)

## 🚨 注意事项

1. **数据隐私**: 数据在本地处理，不会上传到服务器
2. **文件大小**: 建议Excel文件小于50MB
3. **代码安全**: 生成的代码经过安全检查
4. **网络需求**: 需要互联网连接调用AI API

## 🛠️ 故障排除

### 常见问题

**Q: 应用启动失败**
A: 检查依赖是否安装完整: `uv install`

**Q: 文件上传失败**
A: 确认文件格式为.xlsx或.xls，大小不超过限制

**Q: 图表不显示**
A: 检查生成的代码是否包含 `plt.savefig('chart.png')` 命令

**Q: AI回答不准确**
A: 尝试更具体的描述，或者分步骤提问

## 📞 获取帮助

- 查看控制台日志了解详细错误信息
- 尝试重新表述你的问题
- 使用更简单的测试数据验证功能

---

🎉 **开始你的数据探索之旅吧！** 上传Excel文件，输入你的问题，让AI为你解答!